<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>üéÑ Thanh To√°n - Merry Chismart</title>
    <link rel="stylesheet" th:href="@{/css/qxt-style.css}">
</head>
<body class="checkout-page">

<!-- HEADER -->
<th:block th:replace="~{layout/qxtHeader :: qxt_header}"></th:block>

<div class="qxt-page-wrapper">

    <!-- TI√äU ƒê·ªÄ V√Ä TI·∫æN TR√åNH -->
    <div class="checkout-header">
        <h1 class="qxt-page-title">üéÅ Thanh To√°n ƒê∆°n H√†ng Noel</h1>
        <div class="checkout-steps">
            <div class="step active">1. Gi·ªè h√†ng</div>
            <div class="step active">2. Th√¥ng tin & Thanh to√°n</div>
            <div class="step">3. Ho√†n t·∫•t</div>
        </div>
    </div>

    <div class="checkout-layout">
        <!-- C·ªòT TR√ÅI: TH√îNG TIN KH√ÅCH H√ÄNG -->
        <div class="checkout-left">
            <div class="checkout-box">
                <h2 class="section-title">üìù Th√¥ng Tin Giao H√†ng</h2>

                <form th:action="@{/checkout}" th:object="${checkoutForm}" method="post">
                    <div th:if="${#fields.hasGlobalErrors()}" class="qxt-error">
                        <p th:each="err : ${#fields.globalErrors()}" th:text="${err}"></p>
                    </div>

                    <div class="qxt-form-group">
                        <label>H·ªç t√™n ng∆∞·ªùi nh·∫≠n *</label>
                        <input type="text" th:field="*{customerName}" placeholder="Nh·∫≠p h·ªç t√™n ƒë·∫ßy ƒë·ªß">
                        <div class="qxt-field-error" th:errors="*{customerName}"></div>
                    </div>

                    <div class="qxt-form-group">
                        <label>S·ªë ƒëi·ªán tho·∫°i *</label>
                        <input type="text" th:field="*{phone}" placeholder="S·ªë ƒëi·ªán tho·∫°i li√™n h·ªá">
                        <div class="qxt-field-error" th:errors="*{phone}"></div>
                    </div>

                    <div class="qxt-form-group">
                        <label>Email (ƒë·ªÉ nh·∫≠n th√¥ng tin ƒë∆°n h√†ng)</label>
                        <input type="email" placeholder="Email c·ªßa b·∫°n">
                    </div>

                    <div class="qxt-form-group">
                        <label>ƒê·ªãa ch·ªâ nh·∫≠n h√†ng *</label>
                        <textarea rows="2" th:field="*{address}" placeholder="ƒê·ªãa ch·ªâ c·ª• th·ªÉ (s·ªë nh√†, ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh)"></textarea>
                        <div class="qxt-field-error" th:errors="*{address}"></div>
                    </div>

                    <div class="qxt-form-group">
                        <label>Ghi ch√∫ trang tr√≠</label>
                        <textarea rows="2" th:field="*{note}" placeholder="Y√™u c·∫ßu ƒë·∫∑c bi·ªát v·ªÅ trang tr√≠, th·ªùi gian giao h√†ng..."></textarea>
                    </div>
            </div>

            <!-- PH∆Ø∆†NG TH·ª®C THANH TO√ÅN -->
            <div class="checkout-box payment-methods">
                <h2 class="section-title">üí≥ Ph∆∞∆°ng Th·ª©c Thanh To√°n</h2>

                <div class="payment-options">
                    <label class="payment-option">
                        <input type="radio" th:field="*{paymentMethod}" value="COD" checked>
                        <div class="payment-content">
                            <div class="payment-icon">üì¶</div>
                            <div>
                                <h4>Thanh to√°n khi nh·∫≠n h√†ng (COD)</h4>
                                <p>Tr·∫£ ti·ªÅn m·∫∑t khi nh·∫≠n ƒë∆∞·ª£c ƒë·ªì trang tr√≠</p>
                            </div>
                        </div>
                    </label>

                    <label class="payment-option">
                        <input type="radio" th:field="*{paymentMethod}" value="BANK">
                        <div class="payment-content">
                            <div class="payment-icon">üè¶</div>
                            <div>
                                <h4>Chuy·ªÉn kho·∫£n ng√¢n h√†ng</h4>
                                <p>Gi·∫£m th√™m 3% khi chuy·ªÉn kho·∫£n tr∆∞·ªõc</p>
                            </div>
                        </div>
                    </label>

                    <label class="payment-option">
                        <input type="radio" th:field="*{paymentMethod}" value="MOMO">
                        <div class="payment-content">
                            <div class="payment-icon">üíú</div>
                            <div>
                                <h4>V√≠ ƒëi·ªán t·ª≠ MoMo</h4>
                                <p>Thanh to√°n nhanh qua QR MoMo</p>
                            </div>
                        </div>
                    </label>
                </div>

                <!-- TH√îNG TIN CHUY·ªÇN KHO·∫¢N -->
                <div id="bankInfo" class="bank-info-box">
                    <h3>üè¶ Th√¥ng Tin Chuy·ªÉn Kho·∫£n</h3>
                    <div class="bank-details">
                        <div class="bank-qr">
                            <img src="/images/qr-noel.jpg" alt="QR Code Merry Chismart" class="qr-image">
                            <p>Qu√©t m√£ QR ƒë·ªÉ thanh to√°n</p>
                        </div>
                        <div class="bank-account">
                            <div class="account-detail">
                                <span class="label">Ng√¢n h√†ng:</span>
                                <span class="value">VietinBank</span>
                            </div>
                            <div class="account-detail">
                                <span class="label">S·ªë t√†i kho·∫£n:</span>
                                <span class="value">1122 3344 5566</span>
                            </div>
                            <div class="account-detail">
                                <span class="label">Ch·ªß t√†i kho·∫£n:</span>
                                <span class="value">QUACH XUAN THINH</span>
                            </div>
                            <div class="account-detail">
                                <span class="label">N·ªôi dung chuy·ªÉn kho·∫£n:</span>
                                <span class="value">MERRYCHISMART <strong>T√™n_SƒêT</strong></span>
                            </div>
                            <div class="notice">
                                <p>‚ö†Ô∏è <strong>L∆∞u √Ω:</strong> Vui l√≤ng ghi ƒë√∫ng n·ªôi dung ƒë·ªÉ h·ªá th·ªëng t·ª± ƒë·ªông x√°c nh·∫≠n ƒë∆°n h√†ng c·ªßa b·∫°n.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- N√öT ƒê·∫∂T H√ÄNG -->
                <div class="checkout-submit">
                    <button type="submit" class="checkout-btn">üéÖ ƒê·∫∑t H√†ng Ngay</button>
                    <p class="secure-checkout">
                        üîí Thanh to√°n an to√†n ‚Ä¢ B·∫£o m·∫≠t th√¥ng tin ‚Ä¢ ƒê·ªïi tr·∫£ trong 7 ng√†y
                    </p>
                </div>
                </form>
            </div>
        </div>

        <!-- C·ªòT PH·∫¢I: T√ìM T·∫ÆT ƒê∆†N H√ÄNG -->
        <div class="checkout-right">
            <div class="order-summary-box">
                <h2 class="section-title">üì¶ T√≥m T·∫Øt ƒê∆°n H√†ng</h2>

                <div class="order-items">
                    <div class="order-item" th:each="item : ${items}">
                        <div class="item-info">
                            <span class="item-name" th:text="${item.productName}"></span>
                            <span class="item-quantity" th:text="'√ó' + ${item.quantity}"></span>
                        </div>
                        <div class="item-price" th:text="${#numbers.formatInteger(item.price * item.quantity,0,'POINT')} + ' ƒë'"></div>
                    </div>
                </div>

                <div class="order-totals">
                    <div class="total-line">
                        <span>T·∫°m t√≠nh:</span>
                        <span th:text="${#numbers.formatInteger(total,0,'POINT')} + ' ƒë'"></span>
                    </div>
                    <div class="total-line discount">
                        <span>Gi·∫£m gi√° Noel:</span>
                        <span>-50.000 ƒë</span>
                    </div>
                    <div class="total-line shipping">
                        <span>Ph√≠ v·∫≠n chuy·ªÉn:</span>
                        <span>Mi·ªÖn ph√≠</span>
                    </div>
                    <div class="total-line grand-total">
                        <span>T·ªïng thanh to√°n:</span>
                        <span class="grand-total-amount" th:text="${#numbers.formatInteger(total - 50000,0,'POINT')} + ' ƒë'"></span>
                    </div>
                </div>

                <div class="promo-code">
                    <input type="text" placeholder="üéÑ Nh·∫≠p m√£ gi·∫£m gi√°">
                    <button type="button" class="apply-btn">√Åp d·ª•ng</button>
                </div>

                <div class="noel-benefits">
                    <h3>üéÅ ∆Øu ƒê√£i Noel ƒê·∫∑c Bi·ªát</h3>
                    <ul>
                        <li>‚úÖ Mi·ªÖn ph√≠ v·∫≠n chuy·ªÉn to√†n qu·ªëc</li>
                        <li>‚úÖ T·∫∑ng k√®m 1 b·ªô ƒë√®n nh√°y (ƒë∆°n > 500K)</li>
                        <li>‚úÖ Gi·∫£m th√™m 3% khi chuy·ªÉn kho·∫£n</li>
                        <li>‚úÖ H·ªó tr·ª£ t∆∞ v·∫•n trang tr√≠ mi·ªÖn ph√≠</li>
                        <li>‚úÖ ƒê·ªïi tr·∫£ trong 7 ng√†y n·∫øu kh√¥ng h√†i l√≤ng</li>
                    </ul>
                </div>
            </div>

            <div class="support-box">
                <h3>üìû C·∫ßn H·ªó Tr·ª£?</h3>
                <p>Hotline: <strong>0984.551.682</strong> (Zalo/Phone)</p>
                <p>Th·ªùi gian: 8:00 - 22:00 h√†ng ng√†y</p>
                <a href="tel:0984551682" class="support-btn">G·ªçi ngay ƒë·ªÉ ƒë∆∞·ª£c t∆∞ v·∫•n</a>
            </div>
        </div>
    </div>

</div>

<script>
    // Hi·ªÉn th·ªã/·∫©n th√¥ng tin chuy·ªÉn kho·∫£n
    function updatePaymentInfo() {
        const bankOption = document.querySelector('input[value="BANK"]');
        const bankInfo = document.getElementById("bankInfo");

        if (bankOption.checked) {
            bankInfo.style.display = "block";
        } else {
            bankInfo.style.display = "none";
        }
    }

    // G·∫Øn s·ª± ki·ªán cho t·∫•t c·∫£ c√°c radio button
    document.querySelectorAll('input[name="paymentMethod"]').forEach(radio => {
        radio.addEventListener("change", updatePaymentInfo);
    });

    // Kh·ªüi t·∫°o tr·∫°ng th√°i ban ƒë·∫ßu
    updatePaymentInfo();

    // Hi·ªáu ·ª©ng khi nh·∫•n n√∫t √°p d·ª•ng m√£ gi·∫£m gi√°
    document.querySelector('.apply-btn').addEventListener('click', function() {
        const promoInput = document.querySelector('.promo-code input');
        if (promoInput.value.trim() === '') {
            alert('Vui l√≤ng nh·∫≠p m√£ gi·∫£m gi√°!');
        } else {
            alert('üéâ M√£ gi·∫£m gi√° "' + promoInput.value + '" ƒë√£ ƒë∆∞·ª£c √°p d·ª•ng!');
        }
    });
</script>

<th:block th:replace="layout/qxtFooter :: qxt_footer"></th:block>

</body>
</html>